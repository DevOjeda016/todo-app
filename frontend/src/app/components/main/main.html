<!-- Main content -->
<div class="flex flex-row w-full gap-2 relative z-10">
  <div class="relative flex-1">
    <fa-icon
      [icon]="faSearch"
      class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
    ></fa-icon>
    <input
      type="text"
      class="w-full bg-transparent placeholder:text-gray-500 border-sky-600 hover:border-sky-700 focus:border-sky-900 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-full px-10 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border-2 border-2 dark:hover:border-gray-400 shadow-sm focus:shadow"
      placeholder="Buscar tarea..."
      (input)="searchTerm.set($any($event.target).value)"
    />
  </div>
  <div class="flex flex-row gap-2">
    <select
      class="dark:bg-sky-800 dark:hover:bg-sky-900 bg-sky-600 hover:bg-sky-700 font-bold rounded-xl transition-colors text-sky-50 text-center px-2 h-10"
      (change)="onStatusFilterChange($any($event.target).value)"
    >
      <option value="all">Todas</option>
      @for (s of statusOptions; track $index) {
        @if (s !== 'all') {
          <option [value]="s">{{ s }}</option>
        }
      }
    </select>
    <button
      type="button"
      (click)="toggleShowArchived()"
      class="bottom-4 right-4 dark:bg-sky-800 dark:hover:bg-sky-900 bg-sky-600 hover:bg-sky-700 font-bold rounded-full w-10 h-10 transition-colors"
      [class.opacity-50]="!showArchived()"
      [title]="showArchived() ? 'Ocultar archivadas' : 'Mostrar archivadas'"
    >
      <fa-icon [icon]="faArchive" class="text-sky-50"></fa-icon>
    </button>
    <app-theme-selector />
  </div>
</div>

<!-- Tasks grid -->
<section class="mt-4 grid grid-cols-1 gap-3 overflow-y-auto h-3/4 p-4">
  @if (filteredTasks().length === 0) {
    <p class="text-center text-sm text-gray-500 dark:text-gray-400 py-6">
      No hay tareas para mostrar.
    </p>
  } @else {
    @for (task of filteredTasks(); track task.id) {
      <app-task-card
        [task]="task"
        (archiveToggle)="onArchive($event)"
        (changeStatus)="onChangeStatus($event)"
        (delete)="onDelete($event, confirmDialog)"
        (edit)="taskDialog.openForEdit($event)"
      />
    }
  }
</section>

<app-create-task-dialog
  #taskDialog
  (created)="onTaskCreated($event)"
  (updated)="onTaskUpdated($event)"
/>
<app-confirm-dialog #confirmDialog />

<button
  (click)="taskDialog.open()"
  class="absolute bottom-4 right-4 dark:bg-sky-800 dark:hover:bg-sky-900 bg-sky-600 hover:bg-sky-700 font-bold rounded-full w-10 h-10 transition-colors flex items-center justify-center"
>
  <fa-icon [icon]="faPlus" class="text-sky-50"></fa-icon>
</button>
