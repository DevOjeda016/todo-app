<dialog
  #taskModal
  class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-xl p-6 w-96 bg-white dark:bg-slate-900 shadow-lg"
>
  <h2 class="text-lg text-center font-semibold mb-4 text-sky-900 dark:text-slate-100">
    {{ mode === 'create' ? 'Crear Tarea' : 'Editar Tarea' }}
  </h2>

  <form [formGroup]="taskForm" (ngSubmit)="submitTask()" class="flex flex-col gap-3">
    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Título</label>
    <input
      type="text"
      formControlName="title"
      placeholder="Título"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
      [class.border-red-500]="taskForm.controls['title']?.touched && taskForm.controls['title']?.invalid"
    />
    <p class="text-xs text-red-500" *ngIf="taskForm.controls['title']?.touched && taskForm.controls['title']?.errors?.['required']">
      El título es obligatorio.
    </p>
    <p class="text-xs text-red-500" *ngIf="taskForm.controls['title']?.touched && taskForm.controls['title']?.errors?.['maxlength']">
      Máximo 200 caracteres.
    </p>

    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Descripción</label>
    <textarea
      formControlName="description"
      placeholder="Descripción"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
    ></textarea>

    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Fecha límite</label>
    <input
      type="date"
      formControlName="dueDate"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
      [class.border-red-500]="taskForm.controls['dueDate']?.touched && taskForm.controls['dueDate']?.invalid"
    />
    <p class="text-xs text-red-500" *ngIf="taskForm.controls['dueDate']?.touched && taskForm.controls['dueDate']?.errors?.['pattern']">
      Formato inválido (YYYY-MM-DD).
    </p>

    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Minutos estimados</label>
    <input
      type="number"
      formControlName="estimatedMinutes"
      placeholder="Minutos estimados"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
      [class.border-red-500]="taskForm.controls['estimatedMinutes']?.touched && taskForm.controls['estimatedMinutes']?.invalid"
    />
    <p class="text-xs text-red-500" *ngIf="taskForm.controls['estimatedMinutes']?.touched && taskForm.controls['estimatedMinutes']?.errors?.['min']">
      Debe ser mayor o igual a 1.
    </p>

    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Tags</label>
    <input
      type="text"
      formControlName="tags"
      placeholder="Tags separadas por coma"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
    />

    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Importancia</label>
    <select
      formControlName="importance"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
    >
      <option [value]="null" selected>Selecciona una importancia</option>
      @for (importance of importanceValues; track $index) {
        <option [value]="importance">{{ importance }}</option>
      }
    </select>

    <label class="text-sm font-medium text-sky-900 dark:text-sky-100">Estado</label>
    <select
      id="status"
      formControlName="status"
      class="w-full bg-transparent placeholder:text-gray-500 border-gray-600 hover:border-sky-600 focus:border-sky-700 text-sky-900 dark:text-sky-50 text-sm dark:border-gray-100 rounded-2xl px-2 py-2 transition duration-300 ease focus:outline-none dark:focus:border-sky-800 focus:border border dark:hover:border-gray-400 shadow-sm focus:shadow"
    >
      <option [value]="null" selected>Selecciona un estado</option>
      @for (status of statusValues; track $index) {
        <option [value]="status">{{ status }}</option>
      }
    </select>

    <div class="flex justify-center gap-2 mt-2">
      <button
        type="button"
        (click)="close()"
        class="px-3 py-2 w-full rounded-2xl bg-gray-500 text-white hover:bg-gray-600"
      >
        Cancelar
      </button>
      <button
        type="submit"
        [disabled]="taskForm.invalid"
        class="px-3 py-2 w-full rounded-2xl bg-sky-600 text-white hover:bg-sky-700 disabled:opacity-50"
      >
        Guardar
      </button>
    </div>
  </form>
</dialog>
